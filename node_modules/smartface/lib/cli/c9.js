const os = require('os');
const utility = require('../utility');
const collector = require('../collector/index');
const createSmfBinary = require('../smf-binary/index').create;
const smfModule = require('../smfbuilder');
const globalData = require('../globalData');

function run() {
	const argv = globalData.get('args');
	if (!argv.java && /android/i.test(argv.task) ) {
		return utility.javaFinder(function(err, path) {
			globalData.set('args.java', path);
			execute();
		});
	}
	execute();
}

function execute() {
	var config = collector.collect();
	var data = globalData.getData();
	smfModule.run(config, data);
}

exports.handle_task = run;